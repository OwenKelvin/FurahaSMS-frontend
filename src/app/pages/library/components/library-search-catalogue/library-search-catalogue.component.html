<h1>Library Catalogue</h1>

<form (submit)='submitSearchParamsForm()' [formGroup]='searchParamsForm' class="d-flex justify-content-start flex-wrap">
  <section class="col-md-3 col-sm-5">
    <label class="control-label" for="title">Title</label>
    <input formControlName='title' [typeahead]="titles$ | async" typeaheadOptionField="title" placeholder="Enter Title"
      class="form-control" [adaptivePosition]="true">
  </section>
  <section class="col-md-3 col-sm-5">
    <label class="control-label" for="author">Author</label>
    <input formControlName='author' [typeahead]="authors$ | async" typeaheadOptionField="name"
      placeholder="Enter Author" class="form-control" [adaptivePosition]="true">
  </section>
  <section class="col-md-3 col-sm-5">
    <label class="control-label" for="author">Publisher</label>
    <input formControlName='publisher' [typeahead]="publishers$ | async" typeaheadOptionField="name"
      placeholder="Enter Publisher" class="form-control" [adaptivePosition]="true">
  </section>
  <section class="col-lg-3">
    <button class='btn btn-success mt-4'
      [disabled]='!searchParamsForm.dirty || !searchParamsForm.valid || isSubmitting'>
      Search
      <i *ngIf='isSubmitting' class='icon-spin3 animate-spin'></i>
      <i *ngIf='!isSubmitting && searchParamsForm.valid && searchParamsForm.dirty' class='icon-search'></i>
    </button>
  </section>
  <table class="table table-dark mt-2">
    <thead>
      <tr>
        <th>Book Title</th>
        <th>Category</th>
        <th>Publisher</th>
        <th>Total Book Copies</th>
        <th>Available Copies</th>
        <th>Reserved Copies</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor='let book of books'>
        <td>{{ book.title }}</td>
        <td>
          <ul>
            <li *ngFor='let publisher of book.publishers'>
              {{ publisher }}
            </li>
          </ul>
        </td>
        <td>
          <ul>
            <li *ngFor='let cat of book.category'>
              {{ cat }}
            </li>
          </ul>
        </td>
        <td>{{ book.book_items.length }}</td>
        <td>{{ book.available }}</td>
        <td>{{ book.reserves }}</td>
        <td>{{ book.reserves }}</td>
        <td>
          <a [routerLink]='["/library", "books", book.id]' class="btn btn-sm btn-primary"> <span class='icon-eye'></span> <span class="sr-only">View Book</span></a>
        </td>
      </tr>
    </tbody>
  </table>
</form>